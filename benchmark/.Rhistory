knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width=7,
fig.height=6
)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width=7,
fig.height=6
)
library(transcluster)
devtools::install_github("JamesStimson/transcluster", build_vignettes = TRUE)
system.file("extdata", "bc_snp_matrix_R.csv", package = "transcluster", mustWork = TRUE)
library(transcluster)
library(stats)
library(clue)
library(igraph)
ids <- c('A', 'B', 'C', 'D')
dates <- c(2018, 2014, 2016, 2016)
snpMatrix <- matrix(c(0,5,7,7,5,0,8,8,7,8,0,6,7,8,6,0), nrow=4, ncol=4)
myModel <- createModel(ids, dates, snpMatrix)
myModel <- setParams(myModel, lambda=1.5, beta=2.3)
myModel <- setSNPThresholds(myModel, c(5,6,7))
myModel <- setTransThresholds(myModel, c(7,8,9))
mySNPClusters <- makeSNPClusters(myModel, 'test')
myTransClusters <- makeTransClusters(myModel, 'test')
library(transcluster)
myModel <- setCutoffs(myModel)
plotTransClusters(myModel, vSize=20, vFontSize=2, level=7, thick=3, labelOffset=0)
plotTransClusters(myModel, vSize=20, vFontSize=2, level=8, thick=3, labelOffset=0)
plotTransClusters(myModel, vSize=20, vFontSize=2, level=9, thick=3, labelOffset=0)
plotSNPClusters(myModel, vColor='orange', vSize=20, vFontSize=2, level=5, thick=3, labelOffset=0)
plotSNPClusters(myModel, vColor='orange', vSize=20, vFontSize=2, level=6, thick=3, labelOffset=0)
plotSNPClusters(myModel, vColor='orange', vSize=20, vFontSize=2, level=7, thick=3, labelOffset=0)
withinCluster(N = 3, k_cutoff = 5, t1 = 2012.13, t2 = 2015.76, lambda = 0.7, beta = 1.3, perc_cutoff = 0.2)
withinCluster(N = 3, k_cutoff = 5, t1 = 2012.13, t2 = 2015.76, lambda = 0.7, beta = 1.3, perc_cutoff = 0.2)
bcModel <- createModel()
fileName <- system.file("extdata", "mclust12_dates_R.csv", package = "transcluster", mustWork = TRUE)
bcModel <- setDatesFromFile(bcModel, fileName)
fileName <- system.file("extdata", "bc_snp_matrix_R.csv", package = "transcluster", mustWork = TRUE)
bcModel <- setSNPFromFile(bcModel, fileName)
bcModel <- setParams(bcModel, lambda=1.5, beta=2.0)
bcModel <- setCutoffs(bcModel)   #takes a few seconds
bcModel <- setSNPThresholds(bcModel, c(4))
bcModel <- setTransThresholds(bcModel, c(3))
bcSNPClusters <- makeSNPClusters(bcModel, nameBase='test', writeFile=T)
bcTClusters <- makeTransClusters(bcModel, nameBase='test', writeFile=T)
plotSNPClusters(bcModel, level=4, vColor='orange',vSize=4, thick = 1.25)
plotTransClusters(bcModel, level=3, vColor='lightblue',vSize=4, thick = 2, vFontSize=1)
regFileName <- system.file("extdata", "example_region_data.csv", package = "transcluster", mustWork = TRUE)
bcModel <- setRegionsFromFile(bcModel, regFileName)
bcModel <- setCutoffsSpatial(bcModel)
plotTransClustersSpatial(bcModel, level=3, vSize=4, thick=2, vFontSize=1)
getwd  \
getwd
getwd()
setwd(C:\Users\mishra.266\Documents\GitHub\beyond-phylogenies-team5)
setwd("C:\Users\mishra.266\Documents\GitHub\beyond-phylogenies-team5")
setwd("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5")
getwd()
readRDS(/transPhylo/example_transphylo_output.rds)
readRDS(transPhylo/example_transphylo_output.rds)
readRDS(C:\Users\mishra.266\Documents\GitHub\beyond-phylogenies-team5\transPhylo\example_transphylo_matrix.rds)
readRDS("C:\Users\mishra.266\Documents\GitHub\beyond-phylogenies-team5\transPhylo\example_transphylo_matrix.rds")
readRDS("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5\\transPhylo\\example_transphylo_matrix.rds)
readRDS("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5\\transPhylo\\example_transphylo_matrix.rds")
wiw<-readRDS("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5\\transPhylo\\example_transphylo_matrix.rds")
to<-rownames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 1]]
from<-colnames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 2]]
pp<-which(wiw > 0.95, arr.ind = TRUE)
pairs <- data.frame("from"=from, "to"=to)
write.table(pairs,
file=paste0(out, ".pairs"),
col.names=TRUE,
row.names=FALSE,
sep="\t",
quote=FALSE)
wiw<-readRDS("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5\\transPhylo\\example_transphylo_matrix.rds")
to<-rownames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 1]]
from<-colnames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 2]]
pp<-which(wiw > 0.95, arr.ind = TRUE)
pairs <- data.frame("from"=from, "to"=to)
write.table(pairs,
file=paste0(example_transphylo_matrix, ".csv"),
col.names=TRUE,
row.names=FALSE,
sep="\t",
quote=FALSE)
wiw<-readRDS("C:\\Users\\mishra.266\\Documents\\GitHub\\beyond-phylogenies-team5\\transPhylo\\example_transphylo_matrix.rds")
to<-rownames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 1]]
from<-colnames(wiw)[which(wiw > 0.95, arr.ind = TRUE)[, 2]]
pp<-which(wiw > 0.95, arr.ind = TRUE)
pairs <- data.frame("from"=from, "to"=to)
write.table(pairs,
file=example_transphylo_matrix.csv,
col.names=TRUE,
row.names=FALSE,
sep="\t",
quote=FALSE)
setwd("C:/Users/mishra.266/Documents/GitHub/beyond-phylogenies-team5/benchmark")
source("~/.active-rstudio-document")
df_pairs
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
if (!require('igraph')) install.packages('igraph')
source("~/.active-rstudio-document")
install.packages("igraph")
G <- graph.data.frame(df_pairs,directed=FALSE)
library(igraph)
G <- graph.data.frame(df_pairs,directed=FALSE)
G
A <- as_adjacency_matrix(G,names=TRUE,sparse=FALSE)
A
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
fastgreedy.community(df_pairs)
fastgreedy.community(as.undirected(graph.adjacency(df_pairs)))
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
nrow(df_pairs)
df_pairs <- read.table(file = 'transphylo_demo_output.tsv', sep = '\t', header = TRUE)
df[,'connection'] <- 1
df_pairs <- read.table(file = 'transphylo_demo_output.tsv', sep = '\t', header = TRUE)
df_pairs$Connection <- 1
df_pairs
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
m_pairs
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
head(df_pairs)
head(m_pairs)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
#to convert pairwise data from TransPhylo output into cluster data
#install.packages('igraph')
library(igraph)
#read the pairwise output file from transphylo
df_pairs <- read.table(file = 'transphylo_demo_output.tsv', sep = '\t', header = TRUE)
df_pairs$connection <- 1
#transform into a matrix
m_pairs <- graph.data.frame(df_pairs, directed=FALSE)
#make adjacency matrix
matrix_pairs <- as_adjacency_matrix(m_pairs, names=TRUE, sparse=FALSE, attr="connection")
diag(matrix_pairs) <- 0
write.csv(matrix_pairs,"matrix_pairs.csv")
fastgreedy.community(as.undirected(graph.adjacency(matrix_pairs)))
df2$groups
df2 <- fastgreedy.community(as.undirected(graph.adjacency(matrix_pairs)))
df2$groups
df2 <- fastgreedy.community(as.undirected(graph.adjacency(matrix_pairs)))
sizes(df2)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R")
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
library(igraph)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
head(df_clusters)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
df_clusters[,1]
df_clusters[1]
df_clusters[1,]
df_clusters[1,1]
df_clusters$clusterID
df_clusters$name
View(df_clusters)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
df_clusters[1]
df_clusters[1,]
df_clusters[,1]
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
source("~/GitHub/beyond-phylogenies-team5/benchmark/pairs_to_cluster.R", echo=TRUE)
